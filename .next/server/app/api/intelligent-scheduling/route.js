"use strict";(()=>{var e={};e.id=181,e.ids=[181],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},61282:e=>{e.exports=require("child_process")},18539:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>_,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{GET:()=>l,POST:()=>u});var n=r(49303),i=r(88716),o=r(60670),a=r(87070),c=r(61282);async function u(e){try{let t=await e.json(),r=["data_pipeline/utils/intelligent_scheduler.py"];switch(t.action){case"update_schedules":r.push("--update-schedules");break;case"analyze_source":if(!t.source_name)return a.NextResponse.json({error:"source_name is required for analyze_source action"},{status:400});r.push("--analyze-source",t.source_name);break;case"record_metrics":if(!t.source_name||!t.metrics)return a.NextResponse.json({error:"source_name and metrics are required for record_metrics action"},{status:400});return a.NextResponse.json({success:!0,message:"Metrics recording functionality not yet implemented",source_name:t.source_name,metrics:t.metrics});default:return a.NextResponse.json({error:"Invalid action",valid_actions:["update_schedules","analyze_source","record_metrics"]},{status:400})}let s=(0,c.spawn)("python",r,{cwd:process.cwd(),stdio:"pipe"}),n="",i="";s.stdout.on("data",e=>{n+=e.toString()}),s.stderr.on("data",e=>{i+=e.toString()});let o=await new Promise(e=>{let t=setTimeout(()=>{s.kill(),e({success:!1,error:"Intelligent scheduling operation timed out",timeout:!0})},12e4);s.on("close",r=>{clearTimeout(t),e({success:0===r,exit_code:r,output:n,error:i||null})})});if(!o.success)return a.NextResponse.json({success:!1,action:t.action,error:o.error||"Intelligent scheduling operation failed",exit_code:o.exit_code,raw_output:o.output,timeout:o.timeout||!1},{status:500});{let e=null;try{let t=o.output.match(/\{[\s\S]*\}/);t&&(e=JSON.parse(t[0]))}catch(e){}return a.NextResponse.json({success:!0,action:t.action,result:e,raw_output:o.output,execution_time:new Date().toISOString()})}}catch(e){return console.error("Error in intelligent scheduling:",e),a.NextResponse.json({success:!1,error:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function l(e){try{let{searchParams:t}=new URL(e.url),r=t.get("action")||"stats",s=["data_pipeline/utils/intelligent_scheduler.py"];switch(r){case"stats":s.push("--stats");break;case"current_schedules":s.push("--current-schedules");break;default:return a.NextResponse.json({error:"Invalid action parameter",valid_actions:["stats","current_schedules"]},{status:400})}let n=(0,c.spawn)("python",s,{cwd:process.cwd(),stdio:"pipe"}),i="",o="";n.stdout.on("data",e=>{i+=e.toString()}),n.stderr.on("data",e=>{o+=e.toString()});let u=await new Promise(e=>{let t=setTimeout(()=>{n.kill(),e({success:!1,error:"Intelligent scheduling query timed out"})},3e4);n.on("close",r=>{clearTimeout(t),e({success:0===r,output:i,error:o||null})})});if(!u.success)return a.NextResponse.json({error:"Failed to get intelligent scheduling information",details:u.error},{status:500});try{if("current_schedules"===r){let e=function(e){let t=[];for(let r of e.split("\n")){let e=r.match(/^(\w+):\s+(\w+)\s+\((\d+)\s+min\)\s+-\s+(.+)$/);e&&t.push({source_name:e[1],frequency:e[2],interval_minutes:parseInt(e[3]),reason:e[4]})}return t}(u.output);return a.NextResponse.json({timestamp:new Date().toISOString(),current_schedules:e,intelligent_scheduling:{enabled:!0,learning_window_hours:168,adaptation_features:["Activity pattern recognition","Peak hour optimization","Error rate adaptation","Response time consideration","Urgency-based prioritization"]}})}{let e=JSON.parse(u.output);return a.NextResponse.json({timestamp:new Date().toISOString(),scheduling_intelligence:e,system_capabilities:{frequency_levels:["critical","high","normal","low","minimal"],activity_patterns:["burst","steady","periodic","sporadic","dormant"],adaptive_factors:["Activity level","Change rate","Urgency score","Error rate","Response time","System load"]},recommendations:function(e){let t=[];if(e.total_sources<3&&t.push({type:"configuration",priority:"medium",message:"Consider adding more data sources for better scheduling intelligence",action:"expand_sources"}),e.source_performance){let r=e.source_performance.filter(e=>e.avg_efficiency<.5);r.length>0&&t.push({type:"performance",priority:"high",message:`${r.length} sources have low efficiency. Consider optimizing schedules.`,action:"optimize_schedules",affected_sources:r.map(e=>e.source_name)})}if((e.frequency_distribution?.critical||0)>.5*e.total_sources&&t.push({type:"resource_usage",priority:"medium",message:"High number of critical frequency schedules may impact system resources",action:"review_critical_schedules"}),e.source_activity){let r=e.source_activity.filter(e=>{let t=new Date(e.last_metrics);return(Date.now()-t.getTime())/36e5>24});r.length>0&&t.push({type:"data_freshness",priority:"high",message:`${r.length} sources haven't reported metrics in >24 hours`,action:"check_source_connectivity",affected_sources:r.map(e=>e.source_name)})}return t}(e)})}}catch(e){return a.NextResponse.json({error:"Failed to parse scheduling output",raw_output:u.output},{status:500})}}catch(e){return console.error("Error getting intelligent scheduling info:",e),a.NextResponse.json({error:e instanceof Error?e.message:"Unknown error"},{status:500})}}let p=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/intelligent-scheduling/route",pathname:"/api/intelligent-scheduling",filename:"route",bundlePath:"app/api/intelligent-scheduling/route"},resolvedPagePath:"E:\\Download\\savethemnow.Jesus\\src\\app\\api\\intelligent-scheduling\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:m,serverHooks:h}=p,g="/api/intelligent-scheduling/route";function _(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,972],()=>r(18539));module.exports=s})();